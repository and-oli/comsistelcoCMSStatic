(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){e.exports=a(177)},106:function(e,t,a){},177:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),o=a(6),s=a.n(o),l=(a(106),a(11)),c=a(12),r=a(15),d=a(13),m=a(14),p=(a(46),a(75),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).login=function(e){a.setState({loading:!0,loginError:""}),e.preventDefault();var t={username:a.refs.username.value,password:a.refs.password.value};fetch("https://intellgentcms.herokuapp.com/api/authenticateComsistelco",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){a.setState({loading:!1}),e.success?(localStorage.setItem("ComToken",e.token),a.props.setLogged(!0)):a.setState({loginError:e.message})}).catch(function(e){console.error(e)})},a.state={loginError:"",loading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"login"},i.a.createElement("div",{className:"container "},i.a.createElement("div",{className:"profile profile--open"},i.a.createElement("div",{className:"profile__avatar",id:"toggleProfile"},i.a.createElement("img",{src:"./favi.png",alt:"Comsistelco"})),i.a.createElement("form",{className:"profile__form",onSubmit:this.login},i.a.createElement("div",{className:"profile__fields"},i.a.createElement("div",{className:"field"},i.a.createElement("input",{type:"text",id:"fieldUser",className:"input",ref:"username",required:!0,pattern:".*\\S.*"}),i.a.createElement("label",{htmlFor:"fieldUser",className:"label label1"},"Username")),i.a.createElement("div",{className:"field"},i.a.createElement("input",{type:"password",id:"fieldPassword",className:"input",ref:"password",required:!0,pattern:".*\\S.*"}),i.a.createElement("label",{htmlFor:"fieldPassword",className:"label label2"},"Password")),!this.state.loading&&i.a.createElement("div",{className:"profile__footer"},i.a.createElement("button",{className:"btn",type:"submit"},"Login")),this.state.loading&&i.a.createElement("div",{className:"spinner"},i.a.createElement("div",{className:"double-bounce1"}),i.a.createElement("div",{className:"double-bounce2"})),i.a.createElement("label",{className:"login-error"},this.state.loginError))))))}}]),t}(n.Component)),u=a(90),g=a.n(u),h=function(e){function t(){return Object(l.a)(this,t),Object(r.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("header",{className:"header "},i.a.createElement("h1",{className:"title"},"M\xf3dulo administrativo"),i.a.createElement("img",{src:g.a,className:"App-logo",alt:"logo"})),i.a.createElement("div",{className:"logout",onClick:function(){localStorage.removeItem("ComToken"),window.location.reload()}},"salir"))}}]),t}(n.Component),f=a(178),b=a(179),E=a(39),S=f.a.Option,v=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).handleSelection=function(e){a.setState({name:JSON.parse(e).name}),a.props.pageSelected(e)},a.renderOptions=function(){return a.state.pages.map(function(e,t){return i.a.createElement(S,{value:JSON.stringify(e),key:t},e.name)})},a.toggleNewPage=function(){a.setState(function(e){return{newPage:!e.newPage}})},a.submitNewPage=function(e){if(e.preventDefault(),""!==a.refs.newPageName.value.trim()){var t={name:a.refs.newPageName.value,url:a.refs.newPageName.value.replace(/\s/g,""),sections:[]};a.setState({loading:!0,error:""}),fetch("https://intellgentcms.herokuapp.com/api/page",{method:"POST",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){e.success?a.setState(function(e){return{loading:!1,newPages:e.pages.push(t),error:""}}):a.setState({error:e.message,loading:!1})}).catch(function(e){return console.error(e)})}else a.setState({loading:!1,error:"Ingrese un nombre"})},a.showDeleteModal=function(){a.setState({deleteModalVisible:!0})},a.showEditModal=function(){a.setState({editModalVisible:!0})},a.handleOkEdit=function(){if(""!==a.refs.newName.value.trim()){a.setState({loading:!0,error:""});var e={name:a.refs.newName.value,url:a.refs.newName.value.replace(/\s/g,""),originalUrl:a.state.name.replace(/\s/g,"")};fetch("https://intellgentcms.herokuapp.com/api/page",{method:"PUT",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){e.success?(a.setState({editModalVisible:!1,loading:!1,error:""}),window.location.reload()):alert(e.message)}).catch(function(e){return console.error(e)})}else a.setState({error:"No pueden haber campos vac\xedos"})},a.handleOkDelete=function(){a.setState({loading:!0,error:""}),fetch("https://intellgentcms.herokuapp.com/api/page",{method:"DELETE",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({url:a.state.name.replace(/\s/g,"")})}).then(function(e){return e.json()}).then(function(e){e.success?(a.setState({deleteModalVisible:!1,loading:!1,error:""}),window.location.reload()):(a.setState({deleteModalVisible:!1,loading:!1,error:""}),alert(e.message))}).catch(function(e){return console.error(e)})},a.handleCancelEdit=function(){a.setState({editModalVisible:!1})},a.handleCancelDelete=function(){a.setState({deleteModalVisible:!1})},a.state={pages:[],newPage:!1,loading:!1,error:"",deleteModalVisible:!1,editModalVisible:!1,name:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://intellgentcms.herokuapp.com/api/pages").then(function(e){return e.json()}).then(function(t){e.setState({pages:t.pages})}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return i.a.createElement("div",{className:"page-info"},i.a.createElement("div",{className:"selector-label"},"Nombre de la interna"),i.a.createElement(f.a,{defaultValue:"internas",className:"page-selector",style:{width:120},onChange:this.handleSelection,notFoundContent:"No hay p\xe1ginas"},this.renderOptions()),i.a.createElement(b.a,{title:"Title",visible:this.state.editModalVisible,onOk:this.handleOkEdit,confirmLoading:this.state.loading,onCancel:this.handleCancelEdit},i.a.createElement("div",{className:"editModal"},"Nombre:"),i.a.createElement("input",{type:"text",ref:"newName",placeholder:"Nombre de la categor\xeda",className:"form-control",style:{width:"80% !important",margin:"20px 0 20px 0"},defaultValue:this.state.name}),i.a.createElement("div",{style:{color:"red"}},this.state.error)),i.a.createElement(b.a,{title:"Borrar p\xe1gina",visible:this.state.deleteModalVisible,onOk:this.handleOkDelete,confirmLoading:this.state.loading,onCancel:this.handleCancelDelete},i.a.createElement("p",null,"\xbfDesea eliminar esta p\xe1gina?")),this.state.newPage?i.a.createElement(E.a,{type:"close-circle",className:"new-page-btn",onClick:this.toggleNewPage}):i.a.createElement(E.a,{type:"plus-circle",className:"new-page-btn",onClick:this.toggleNewPage}),i.a.createElement("div",{style:{marginTop:"20px"}},this.state.name&&i.a.createElement("button",{className:"btn",onClick:this.showEditModal,style:{width:"20%",marginRight:"20px"}},"Editar"),this.state.name&&i.a.createElement("button",{className:"btn",onClick:this.showDeleteModal,style:{width:"20%"}},"Eliminar")),this.state.newPage&&i.a.createElement("form",{className:"new-page",onSubmit:this.submitNewPage},i.a.createElement("div",{className:"subsubtitle new-page-item"},i.a.createElement("span",null," Nueva p\xe1gina")),i.a.createElement("input",{type:"text",ref:"newPageName",placeholder:"Nombre de la p\xe1gina",className:"form-control text-input new-page-item ",rows:"1"}),this.state.loading?i.a.createElement("div",{className:"spinner"},i.a.createElement("div",{className:"double-bounce1"}),i.a.createElement("div",{className:"double-bounce2"})):i.a.createElement("div",null,i.a.createElement("button",{className:"btn new-page-item",style:{width:"40%"},type:"submit"},"Agregar"),i.a.createElement("div",{style:{color:"red"}},this.state.error))))}}]),t}(n.Component),N=a(40),w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).submitNewSection=function(e){if(e.preventDefault(),""!==a.refs.title.value.trim()&&""!==a.refs.content.value.trim()){a.setState({loading:!0,error:""});var t=[];if(a.refs.images.files[0]){(function e(a){var n=this;this.uploadFile(this.refs.images.files[a]).then(function(i){t.push(i.imageUrl),++a<n.refs.images.files.length?e.bind(n)(a):n.submitSection(t)}).catch(function(e){alert("Ocurri\xf3 un error subiendo las im\xe1genes"),console.error(e)})}).bind(Object(N.a)(Object(N.a)(a)))(0)}else a.submitSection([])}else a.setState({error:"Ingrese todos los campos"})},a.submitSection=function(e){var t={images:e,title:a.refs.title.value,content:a.refs.content.value,page:{_id:a.props.pageSelected._id,name:a.props.pageSelected.name,url:a.props.pageSelected.url}};fetch("https://intellgentcms.herokuapp.com/api/section",{method:"POST",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){a.setState({loading:!1}),e.success?(t._id=e.id,a.props.newSection(t)):alert(e.message)}).catch(function(e){a.setState({loading:!1}),alert("Ocurri\xf3 un error"),console.error(e)})},a.uploadFile=function(e){var t=new FormData;return t.append("image",e),fetch("https://intellgentcms.herokuapp.com/api/uploadPicture",{method:"POST",headers:{"x-access-token":localStorage.getItem("ComToken")},body:t}).then(function(e){return e.json()})},a.state={loading:!1,error:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"new-section"},i.a.createElement("h2",{className:"subtitle"},"Nueva secci\xf3n"),i.a.createElement("form",{onSubmit:this.submitNewSection},i.a.createElement("textarea",{ref:"title",className:"form-control text-input new-section-title",rows:"1",placeholder:"Titulo"}),i.a.createElement("textarea",{ref:"content",className:"form-control text-input new-section-content",rows:"4",placeholder:"Contenido"}),i.a.createElement("div",{className:"images-label"},"Im\xe1genes"),i.a.createElement("div",{className:" images-input-wrapper"},i.a.createElement("input",{id:"file-upload",className:"text-input images-input",type:"file",ref:"images",name:"myimages",accept:"image/*",multiple:!0}),i.a.createElement("br",null)),!this.state.loading&&i.a.createElement("button",{className:"btn",style:{marginLeft:"10%"},type:"submit"},"Agregar"),this.state.loading&&i.a.createElement("div",{className:"spinner"},i.a.createElement("div",{className:"double-bounce1"}),i.a.createElement("div",{className:"double-bounce2"})),i.a.createElement("label",{className:"login-error"},this.state.error)))}}]),t}(n.Component),O=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).showEditModal=function(){a.setState({editModalVisible:!0})},a.showDeleteModal=function(){a.setState({deleteModalVisible:!0})},a.handleOkEdit=function(){if(""!==a.refs.newTitle.value.trim()&&""!==a.refs.newContent.value.trim()){a.setState({loading:!0,error:""});var e={_id:a.props.section._id,page:a.props.pageSelected,content:a.refs.newContent.value,title:a.refs.newTitle.value};fetch("https://intellgentcms.herokuapp.com/api/section",{method:"PUT",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(t){t.success?(a.setState({editModalVisible:!1,loading:!1,error:""}),a.props.sectionEdited(e)):alert(t.message)}).catch(function(e){return console.error(e)})}else a.setState({error:"No pueden haber campos vac\xedos"})},a.handleOkDelete=function(){a.setState({loading:!0,error:""});var e={_id:a.props.section._id,page:a.props.pageSelected};fetch("https://intellgentcms.herokuapp.com/api/section",{method:"DELETE",headers:{"x-access-token":localStorage.getItem("ComToken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(t){t.success?(a.setState({deleteModalVisible:!1,loading:!1,error:""}),a.props.sectionDeleted(e)):alert(t.message)}).catch(function(e){return console.error(e)})},a.handleCancelEdit=function(){a.setState({editModalVisible:!1})},a.handleCancelDelete=function(){a.setState({deleteModalVisible:!1})},a.showImages=function(){if(a.props.section.images)return a.props.section.images.map(function(e,t){return i.a.createElement("img",{src:e,className:"thumbnail"})})},a.state={editModalVisible:!1,deleteModalVisible:!1,loading:!1,error:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"section-wrapper"},i.a.createElement("div",{className:"section"},i.a.createElement("h2",{className:"section-title"}," ",this.props.section.title),i.a.createElement("div",{className:"section-content"}," ",this.props.section.content),i.a.createElement("div",{className:"images-wrapper"},this.showImages())),i.a.createElement("div",{className:"section-icons"},i.a.createElement(E.a,{className:"section-icon",type:"edit",onClick:this.showEditModal}),i.a.createElement(b.a,{title:"Title",visible:this.state.editModalVisible,onOk:this.handleOkEdit,confirmLoading:this.state.loading,onCancel:this.handleCancelEdit},i.a.createElement("div",{className:"editModal"},"Nombre:"),i.a.createElement("input",{type:"text",ref:"newTitle",placeholder:"Nombre de la categor\xeda",className:"form-control",style:{width:"80% !important",margin:"20px 0 20px 0"},defaultValue:this.props.section.title}),i.a.createElement("div",{className:"editModal"}," Descripci\xf3n"),i.a.createElement("input",{type:"text",ref:"newContent",placeholder:"Descripci\xf3n de la categor\xeda",className:"form-control",style:{width:"80% !important",margin:"20px 0 20px 0"},defaultValue:this.props.section.content}),i.a.createElement("div",{style:{color:"red"}},this.state.error)),i.a.createElement(E.a,{className:"section-icon",type:"delete",onClick:this.showDeleteModal}),i.a.createElement(b.a,{title:"Title",visible:this.state.deleteModalVisible,onOk:this.handleOkDelete,confirmLoading:this.state.loading,onCancel:this.handleCancelDelete},i.a.createElement("p",null,"\xbfDesea eliminar esta Secci\xf3n de la p\xe1gina?"))))}}]),t}(n.Component),y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).showSections=function(){return a.props.pageSelected.sections.map(function(e,t){return i.a.createElement(O,{key:t,section:e,pageSelected:a.props.pageSelected,sectionEdited:a.props.sectionEdited,sectionDeleted:a.props.sectionDeleted})})},a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("h2",{className:"subtitle"},"Secciones en la interna"),this.showSections())}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).pageSelected=function(e){a.setState({pageSelected:JSON.parse(e)})},a.newSection=function(e){alert("Secci\xf3n a\xf1adida a la p\xe1gina"),a.setState(function(t){return t.pageSelected.sections.push(e),{pageSelected:t.pageSelected}})},a.sectionEdited=function(e){a.setState(function(t){for(var a=0;a<t.pageSelected.sections.length;a++)if(t.pageSelected.sections[a]._id===e._id){t.pageSelected.sections[a].title=e.title,t.pageSelected.sections[a].content=e.content;break}return{pageSelected:t.pageSelected}})},a.sectionDeleted=function(e){a.setState(function(t){for(var a=0;a<t.pageSelected.sections.length;a++)if(t.pageSelected.sections[a]._id===e._id){t.pageSelected.sections.splice(a,1);break}return{pageSelected:t.pageSelected}})},a.state={pageSelected:null,loading:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://intellgentcms.herokuapp.com/api/pages").then(function(e){return e.json()}).then(function(t){e.setState({loading:!1})}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return this.state.loading?i.a.createElement("div",{className:"spinner"},i.a.createElement("div",{className:"double-bounce1"}),i.a.createElement("div",{className:"double-bounce2"})):i.a.createElement("div",null,i.a.createElement(h,null),i.a.createElement("div",{className:"home-wrapper"},i.a.createElement(v,{pageSelected:this.pageSelected}),this.state.pageSelected&&i.a.createElement("div",null,i.a.createElement("div",{className:"page-title"},this.state.pageSelected.name),i.a.createElement(w,{pageSelected:this.state.pageSelected,newSection:this.newSection}),i.a.createElement(y,{pageSelected:this.state.pageSelected,sectionEdited:this.sectionEdited,sectionDeleted:this.sectionDeleted}))))}}]),t}(n.Component),k=(a(175),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).setLogged=function(e){a.setState({logged:e})},a.state={logged:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("ComToken")?this.setState({logged:!0}):this.setState({logged:!1})}},{key:"render",value:function(){return this.state.logged?i.a.createElement(j,{setLogged:this.setLogged}):i.a.createElement(p,{setLogged:this.setLogged})}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},46:function(e,t,a){},75:function(e,t,a){},90:function(e,t,a){e.exports=a.p+"static/media/favicropped.f68a87ee.png"}},[[101,2,1]]]);
//# sourceMappingURL=main.089fb631.chunk.js.map